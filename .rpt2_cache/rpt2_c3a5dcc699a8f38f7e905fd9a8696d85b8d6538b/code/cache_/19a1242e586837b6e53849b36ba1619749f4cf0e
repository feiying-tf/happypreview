{"map":"{\"version\":3,\"file\":\"happypreview.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/core/happypreview.ts\"],\"names\":[],\"mappings\":\"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\"}","code":"import { __awaiter, __generator } from \"tslib\";\r\nimport PhotoSwipe from 'photoswipe';\r\nimport PhotoSwipeUI_Default from 'photoswipe/dist/photoswipe-ui-default';\r\nimport ShowContainer from './showContainer.vue';\r\nimport 'photoswipe/dist/default-skin/default-skin.css';\r\nimport 'photoswipe/dist/photoswipe.css';\r\nvar parseThumbnailElements = function (items, isFn) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var arr, i, len;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    arr = [];\r\n                    i = 0, len = items.length;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(i < len)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, new Promise(function (resolve, reject) {\r\n                            try {\r\n                                var current_1;\r\n                                var src_1 = '';\r\n                                if (isFn) {\r\n                                    src_1 = items[i];\r\n                                }\r\n                                else {\r\n                                    current_1 = items[i];\r\n                                    src_1 = current_1.getAttribute('big') || current_1.getAttribute('src');\r\n                                }\r\n                                var image_1 = document.createElement('img');\r\n                                image_1.setAttribute('src', src_1);\r\n                                image_1.onload = function () {\r\n                                    arr.push({\r\n                                        src: src_1,\r\n                                        w: image_1.offsetWidth || image_1.width || 1024,\r\n                                        h: image_1.offsetHeight || image_1.height || 1024,\r\n                                        msrc: isFn ? src_1 : current_1.getAttribute('src'),\r\n                                        el: isFn ? image_1 : current_1,\r\n                                        title: isFn ? '' : current_1.getAttribute('previewTitle')\r\n                                    });\r\n                                    resolve();\r\n                                };\r\n                            }\r\n                            catch (error) {\r\n                                reject(error);\r\n                            }\r\n                        })];\r\n                case 2:\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3:\r\n                    i++;\r\n                    return [3 /*break*/, 1];\r\n                case 4: return [2 /*return*/, arr];\r\n            }\r\n        });\r\n    });\r\n};\r\nvar openPhotoSwipe = function (index, items, disableAnimation, fromURL, isFn) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var pswpElement, gallery, options, itemsTemp, j;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    pswpElement = document.querySelectorAll('.pswp')[0];\r\n                    return [4 /*yield*/, parseThumbnailElements(items, isFn)];\r\n                case 1:\r\n                    itemsTemp = _a.sent();\r\n                    options = {\r\n                        // define gallery index (for URL)\r\n                        // galleryUID: items[index].getAttribute(\"data-pswp-uid\"), // 获取.data-pswp-uid 属性\r\n                        history: false,\r\n                        shareEl: false,\r\n                        preloaderEl: true,\r\n                        getThumbBoundsFn: function (index) {\r\n                            // See Options -> getThumbBoundsFn section of documentation for more info\r\n                            var thumbnail = isFn ? itemsTemp[index].el : items[index], // find thumbnail\r\n                            pageYScroll = window.pageYOffset || document.documentElement.scrollTop, // 获取被卷去的高度\r\n                            rect = thumbnail.getBoundingClientRect(); // 返回缩略图的大小及其相对于视口的位置\r\n                            return { x: rect.left, y: rect.top + pageYScroll, w: rect.width };\r\n                        }\r\n                    };\r\n                    // PhotoSwipe opened from URL\r\n                    if (fromURL) {\r\n                        // 当 fromURL 为真的时候\r\n                        if (options.galleryPIDs) {\r\n                            // parse real index when custom PIDs are used\r\n                            // http://photoswipe.com/documentation/faq.html#custom-pid-in-url\r\n                            for (j = 0; j < itemsTemp.length; j++) {\r\n                                if (itemsTemp[j].pid == index) {\r\n                                    options.index = j;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        else {\r\n                            // in URL indexes start from 1\r\n                            options.index = parseInt(index, 10) - 1;\r\n                        }\r\n                    }\r\n                    else {\r\n                        options.index = parseInt(index, 10);\r\n                    }\r\n                    if (disableAnimation) {\r\n                        // 当disableAnimation为真\r\n                        options.showAnimationDuration = 0;\r\n                    }\r\n                    // Pass data to PhotoSwipe and initialize it\r\n                    gallery = new PhotoSwipe(// 创建一个画廊\r\n                    pswpElement, // 传入 .pswp对应的元素\r\n                    PhotoSwipeUI_Default, itemsTemp, // 传入itemsTemp\r\n                    options // 传入options\r\n                    );\r\n                    gallery.init(); // 初始化画廊\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n};\r\n/**\r\n * imgMark 图片的标志，一个class，或者一个id\r\n * @param {*} imgMark\r\n */\r\nvar initPhotoSwipeFromDOM = function (imgMark) {\r\n    // parse slide data (url, title, size ...) from DOM elements\r\n    // (children of imgMark)\r\n    // find nearest parent element\r\n    // 点击事件\r\n    var onThumbnailsClick = function (e) {\r\n        e = e || window.event;\r\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\r\n        var eTarget = e.target || e.srcElement;\r\n        var id = eTarget.getAttribute(imgMark);\r\n        var items = document.querySelectorAll(\"[\" + imgMark + \"=\\\"\" + id + \"\\\"]\");\r\n        var index;\r\n        for (var i_1 = 0, len = items.length; i_1 < len; i_1++) {\r\n            if (items[i_1] === eTarget) {\r\n                index = i_1;\r\n            }\r\n        }\r\n        if (index >= 0) {\r\n            // 如果被点击的元素为有效元素\r\n            openPhotoSwipe(index, items);\r\n        }\r\n        return false;\r\n    };\r\n    // parse picture index and gallery index from URL (#&pid=1&gid=2)\r\n    // var photoswipeParseHash = function() {\r\n    //   var hash = window.location.hash.substring(1),\r\n    //     params = {};\r\n    //   if (hash.length < 5) {\r\n    //     return params;\r\n    //   }\r\n    //   var vars = hash.split(\"&\");\r\n    //   for (var i = 0; i < vars.length; i++) {\r\n    //     if (!vars[i]) {\r\n    //       continue;\r\n    //     }\r\n    //     var pair = vars[i].split(\"=\");\r\n    //     if (pair.length < 2) {\r\n    //       continue;\r\n    //     }\r\n    //     params[pair[0]] = pair[1];\r\n    //   }\r\n    //   if (params.gid) {\r\n    //     params.gid = parseInt(params.gid, 10);\r\n    //   }\r\n    //   return params;\r\n    // };\r\n    // 获取所有的类名为 imgMark 的元素\r\n    var imgElements = document.querySelectorAll('[' + imgMark + ']');\r\n    for (var i = 0, l = imgElements.length; i < l; i++) {\r\n        // 为每一个元素添加 data-pswp-uid 属性，并依次 + 1\r\n        imgElements[i].setAttribute('data-pswp-uid', i + 1 + '');\r\n        imgElements[i].onclick = onThumbnailsClick;\r\n    }\r\n    // Parse URL and open gallery if it contains #&pid=3&gid=1\r\n    // 如果hash值上面有pid和gid，那么就显示画廊\r\n    // var hashData = photoswipeParseHash();\r\n    // if (hashData.pid && hashData.gid) {\r\n    //   openPhotoSwipe(\r\n    //     hashData.pid,\r\n    //     imgElements[hashData.gid - 1],\r\n    //     true,\r\n    //     true\r\n    //   );\r\n    // }\r\n};\r\nexport var happypreview = function (argu) {\r\n    if (argu && typeof argu !== 'object') {\r\n        throw new Error('Parameters can only be arrays and objects');\r\n    }\r\n    var images = []; // 图片集\r\n    var start = 0; // 默认开始的位置\r\n    if (Array.isArray(argu)) {\r\n        images = argu;\r\n    }\r\n    else if (typeof argu === 'object') {\r\n        images = argu.images;\r\n        start = argu.start;\r\n    }\r\n    openPhotoSwipe(start, images, false, false, true);\r\n};\r\nhappypreview.install = function (Vue, options) {\r\n    if (options === void 0) { options = { select: 'previewId' }; }\r\n    // 创建显示图片的容器，并把它追加到body里面\r\n    var previewWrapper = document.createElement('div');\r\n    document.body.appendChild(previewWrapper);\r\n    previewWrapper.id = 'preview-wrapper';\r\n    // 将ShowContainer挂载到previewWrapper上\r\n    var Preview = Vue.extend(ShowContainer);\r\n    // 创建 Profile 实例，并挂载到一个元素上。\r\n    new Preview().$mount('#preview-wrapper');\r\n    Vue.prototype.$happypreview = happypreview;\r\n    Vue.mixin({\r\n        mounted: function () {\r\n            initPhotoSwipeFromDOM(options.select);\r\n        }\r\n    });\r\n};\r\nexport default happypreview;\r\nif (typeof window !== 'undefined' && !window.happypreview) {\r\n    ;\r\n    window.happypreview = happypreview;\r\n}\r\n//# sourceMappingURL=happypreview.js.map","dts":{"name":"/Users/tangfeng/Documents/前端/project/happypreview/dist/types/core/happypreview.d.ts","writeByteOrderMark":false,"text":"import 'photoswipe/dist/default-skin/default-skin.css';\r\nimport 'photoswipe/dist/photoswipe.css';\r\nimport { Happypreview } from '../types/index';\r\nexport declare let happypreview: Happypreview;\r\nexport default happypreview;\r\n"}}
